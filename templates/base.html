<!DOCTYPE html>
<html lang="en" data-theme="{{ request.cookies.get('portal-theme', 'light') }}">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ title or "JobsPlanet - Find Your Dream Job" }}</title>
  <meta name="description" content="Find your dream job with your interest and skills - JobsPlanet recruitment platform" />
  <meta name="csrf-token" content="{{ csrf_token() if csrf_token is defined else '' }}" />

  <!-- Primary styles -->
  <link rel="stylesheet" href="{{ url_for('static', path='portal.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', path='styles.css') }}" />

  <!-- Inline theme-init to avoid flash-of-unstyled-theme -->
  <script>
    (function(){
      try {
        const saved = localStorage.getItem('portal-theme');
        if(saved) document.documentElement.setAttribute('data-theme', saved);
      } catch(e){}
    })();
  </script>

  {% block head_extra %}{% endblock %}
  <style>
    /* JobsPlanet theme */
    :root{--primary:#4F46E5;--bg1:#F8FAFC;--card:#fff;--text:#1E293B;--text-muted:#64748B;}
    html,body{height:100%;margin:0;font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;background:#F8FAFC;}
    .container{max-width:1200px;margin:0 auto;padding:0 20px;}
  </style>
</head>
<body>
  <!-- Top navigation -->
  <header class="jobsplanet-nav" role="banner">
    <div class="container">
      <div class="nav-content">
        <a href="{{ url_for('landing') }}" class="brand">
          <span class="brand-jobs">Jobs</span><span class="brand-planet">Planet</span>
        </a>

        <nav class="main-nav" role="navigation" aria-label="Main">
          <a href="{{ url_for('landing') }}" class="nav-item">Home</a>
          <a href="#" class="nav-item">How It Works</a>
          <a href="#" class="nav-item">About Us</a>
          <a href="#" class="nav-item">Contact Us</a>
        </nav>

        <div class="auth-buttons">
          {% if user %}
            <span class="user-greeting">Hi, {{ user.name }}</span>
            <a href="{{ url_for('logout') }}" class="btn-logout">Logout</a>
          {% else %}
            <button id="open-auth" class="btn-login">Log In</button>
            <button id="btn-candidate" class="btn-signup">Sign Up</button>
          {% endif %}
        </div>
      </div>
    </div>
  </header>

  <!-- Flash -->
  {% if flash %}
    <div class="flash-message">{{ flash }}</div>
  {% endif %}

  <!-- Main content area -->
  <main class="main-content">
    {% block content %}{% endblock %}
  </main>

  <!-- Shared UI containers -->
  <div id="ui-roots">
    <div id="modal-root" aria-live="polite"></div>
    <div id="toast-root" aria-live="assertive" aria-atomic="true"></div>
  </div>

  <!-- Footer -->
  <footer class="jobsplanet-footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <span class="brand-jobs">Jobs</span><span class="brand-planet">Planet</span>
          <p>Find your dream job with your interest and skills</p>
        </div>
        <div class="footer-links">
          <div class="footer-col">
            <h4>Company</h4>
            <a href="#">About Us</a>
            <a href="#">Careers</a>
            <a href="#">Contact</a>
          </div>
          <div class="footer-col">
            <h4>Support</h4>
            <a href="#">Help Center</a>
            <a href="#">Privacy Policy</a>
            <a href="#">Terms of Service</a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>Â© {{ now.year if now is defined else "2025" }} JobsPlanet. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Minimal inline behaviors that must run before deferred JS -->
  <script>
    // a11y: close dialogs with ESC globally (portal.js will add robust handling too)
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        const open = document.querySelector('.modal-backdrop.show, .modal-backdrop[aria-hidden="false"]');
        if (open) open.dispatchEvent(new CustomEvent('requestClose', { bubbles: true }));
      }
    });
  </script>

  <!-- Main script (deferred) -->
  <script defer src="{{ url_for('static', path='portal.js') }}"></script>
  {% block scripts_extra %}{% endblock %}
</body>
</html>
